<div class="comment-top">
    <h4>Yorum Bırakın</h4>
    <div class="comment-bottom">
        <form id="commentForm">
            <input type="hidden" id="blogId" value="@ViewBag.i">
            <input class="form-control" type="text" id="commentUserName" placeholder="Adınız Soyadınız" required="">
            <input class="form-control" type="text" id="commentTitle" placeholder="Konu" required="">
            <textarea class="form-control" id="commentContent" placeholder="Yorumunuz..." required=""></textarea>
            <button type="button" id="submitComment" class="btn btn-primary submit">Yorum Yap</button>
        </form>
        <p id="commentMessage" style="color: green;"></p> <!-- AJAX sonucu buraya yazılacak -->
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#submitComment").click(function (event) {
            event.preventDefault(); // Sayfanın yenilenmesini engelle

            let commentData = {
                BlogID: $("#blogId").val(), // Blog ID'yi al
                CommentUserName: $("#commentUserName").val(), // Kullanıcı adını al
                CommentTitle: $("#commentTitle").val(), // Yorum başlığını al
                CommentContent: $("#commentContent").val() // Yorum içeriğini al
            };

            if (!commentData.CommentUserName || !commentData.CommentContent) {
                $("#commentMessage").text("Ad ve Yorum alanı zorunludur!");
                return;
            }

            $("#submitComment").prop("disabled", true); // Çift tıklamayı önle

            $.ajax({
                type: "POST",
                url: "/Comment/PartialAddComment",
                data: commentData,
                success: function (response) {
                    $("#commentMessage").text(response);
                    $("#commentForm")[0].reset(); // Formu temizle
                    $("#submitComment").prop("disabled", false); // Butonu tekrar aktif yap
                },
                error: function () {
                    $("#commentMessage").text("Bir hata oluştu. Lütfen tekrar deneyin.");
                    $("#submitComment").prop("disabled", false);
                }
            });
        });
    });
</script>
